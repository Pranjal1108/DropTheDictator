<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Drop Game</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Bruno+Ace&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">

  <style>
    #loadingOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 20000;
      transition: opacity 0.5s ease-in-out;
      background: #ffe802;
    }

    .loading-bar-container {
      width: 80%;
      max-width: 600px;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      overflow: hidden;
      position: absolute;
      bottom: 50px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    .loading-bar-fill {
      height: 100%;
      width: 0%;
      /* Controlled by JS */
      background: #ffd700;
      border-radius: 3px;
      transition: width 0.1s linear;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    }

    @media (max-width: 1024px) {
      #studioVideo {
        object-fit: contain !important;
      }
    }
  </style>
</head>

<body>
  <!-- 1. LOADING OVERLAY (Studio Intro + Preloader) -->
  <div id="loadingOverlay">
    <video id="studioVideo" autoplay muted playsinline
      style="width: 100%; height: 100%; object-fit: cover; position: absolute; inset: 0;">
      <source src="items/BollyGamesIntroFixed.mp4" type="video/mp4" />
    </video>
    <div class="loading-bar-container" style="z-index: 2">
      <div id="loadingBarFill" class="loading-bar-fill" style="width: 0%"></div>
    </div>
  </div>

  <!-- 2. GAME INTRO VIDEO (Plays after loading) -->
  <video id="gameIntroVideo" playsinline
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 10000; background: black;">
    <source src="items/new_intro.mp4" type="video/mp4" />
  </video>

  <!-- 3. START SCREEN (Press Any Key) -->
  <div id="startScreen"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: black; z-index: 10000; cursor: pointer; display: flex; justify-content: center; align-items: center;">
    <h1
      style="color: white; font-family: 'Luckiest Guy', cursive; font-size: 4rem; text-align: center; text-shadow: 0 0 20px #ffd700;">
      TAP TO START</h1>
  </div>

  <main>
    <div id="viewport">

      <div id="starfield"></div>

      <div id="game-scale">
        <div id="game">
          <div id="world">
            <div id="ground"></div>
            <div id="sky">
              <div class="cloud-layer back"></div>
              <div class="cloud-layer mid"></div>
              <div class="cloud-layer front"></div>
            </div>

            <div id="player">
              <div id="head"></div>
              <div id="torso"></div>
              <div id="left-arm"></div>
              <div id="right-arm"></div>
              <div id="left-leg"></div>
              <div id="right-leg"></div>
            </div>

            <div id="sprite"></div>
            <div id="skeleton"></div>
          </div>
          <canvas id="debugColliders"></canvas>

          <div class="bet-ui">
            <div class="balance-card" id="balance">Balance ₹1000.00</div>

            <div class="bet-box">
              <button id="minus">−</button>
              <input id="betAmount" type="number" min="10" max="999999">
              <button id="plus">+</button>
            </div>

            <div class="quick-bets">
              <button class="chip" data-v="10">₹10</button>
              <button class="chip" data-v="50">₹50</button>
              <button class="chip" data-v="100">₹100</button>
              <button class="chip" data-v="max">MAX</button>
            </div>

            <button id="bonusToggle" class="bonus-toggle">BONUS</button>

            <button id="placeBet" class="bet-button">PLACE BET</button>
          </div>

          <div id="score">₹0</div>
          <div id="multiplier">×1</div>
          <div id="flipText"></div>

          <div id="runOver" style="cursor: pointer;"></div>
        </div>
      </div>

      <!-- Rules Modal -->
      <div id="rulesModal" class="modal" style="display: none;">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h2>Game Rules</h2>
          <p><strong>How to Play:</strong> Control the character to collect coins and avoid obstacles. The game ends
            when you land on the ground.</p>
          <p><strong>RTP:</strong> 95.5% (normal mode), 94.2% (bonus mode)</p>
          <p><strong>Max Win:</strong> 1000x bet amount</p>
          <p><strong>Bonus Feature:</strong> Black holes provide multipliers up to 10x</p>
          <p><strong>Disclaimer:</strong> Malfunction voids all wins and plays. The game display is for illustrative
            purposes only. Winnings are settled according to the amount received from the Remote Game Server.</p>
        </div>
      </div>

      <button id="rulesBtn"
        style="position: fixed; bottom: 20px; right: 20px; padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">Rules</button>

    </div>
  </main>

  <script src="script.js"></script>
</body>

</html>